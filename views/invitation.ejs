<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link href="/stylesheets/event.css" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a2d20e5bcc.js" crossorigin="anonymous"></script>
  <title>Get Link</title>
</head>

<body>
  <h1 id="url" class="hidden-url"><%=url%><h1>
  <div class="arrow prev"><i class="arrow-icon fa-solid fa-angle-left"></i></div>
  <div class="arrow next"><i class="arrow-icon fa-solid fa-angle-right"></i></div>
  <div class="link-ctn-box">
    <h1 class="link-header">How would you like to send your invitation?</h1>
    <div class="copy-text">
      <input type="text" class="text" id="linkID" value=<%=event_id%>>
      <button class="copy-button">
        <i class="fa-solid fa-clone"></i>
      </button>
    </div>
    <div class="link-ctn">
      <div class="link-box" id="meetingID"><i class="fa-solid fa-id-badge"></i><span>Meeting ID Link</span></div>
      <div class="link-box"><i class="fa-solid fa-envelope"></i><span>Mail Invitation</span></div>
      <div class="link-box"><i class="fa-brands fa-facebook"></i><span>Facebook Invitation</span></div>
    </div>
  </div>
  <script>
    var url = document.getElementById("url").textContent;
    let copyText = document.querySelector(".copy-text");
    copyText.querySelector("button").addEventListener("click", function(){
      copyText.classList.add("active")
      setTimeout(function() {
        copyText.classList.remove("active")
      }, 1000)
    })

    let path = url+'/users/invitation-response';
    function serialize(id) {
      let res = "";
      while (id != 0) {
        let remainder = id % 26;
        id = Math.floor(id / 26);
        res = res + String.fromCharCode(remainder + 97);
      }
      console.log(res)
      while (res.length < 6) {
        res = res + 'A';
      }
      return res.split("").reverse().join("");
    }

    function deserialize(id) {
      res = 0;
      for (let i = 0; i < id.length; i++) {
        res = res + (id.charCodeAt(i) - 65) * (26 ** (id.length - 1 - i));
      }
      return res;
    }

    window.onload = function() {
      var showID = document.getElementById("meetingID");
      let id = document.getElementById("linkID").value;
      let serializedID = serialize(parseInt(id));

      document.getElementById("linkID").value = path + '/' + serializedID;
    };


  </script>
</body>

</html>